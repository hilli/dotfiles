#!/bin/bash

# killport - Kill a process using a specified port on macOS

set -e

if [ -z "$1" ]; then
    echo "Usage: killport <port>"
    echo "Example: killport 8080"
    exit 1
fi

PORT="$1"

# Validate that port is a number
if ! [[ "$PORT" =~ ^[0-9]+$ ]]; then
    echo "Error: Port must be a number"
    exit 1
fi

# Find the PID using the port
PID=$(lsof -ti :"$PORT" 2>/dev/null)

if [ -z "$PID" ]; then
    echo "No process found using port $PORT"
    exit 0
fi

# Kill the process(es)
echo "Killing process(es) on port $PORT: $PID"
echo "$PID" | xargs kill -9

echo "Port $PORT is now free"
